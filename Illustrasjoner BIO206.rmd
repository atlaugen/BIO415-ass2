---
title: "R Notebook"
output: html_notebook
---
```{r}
library(tidyverse)
library(readxl)
library(scales)
```

```{r}
read_excel("Elg.xlsx") %>% 
  ggplot(aes(x = År, y = `Felte elg`)) +
  geom_line(color = "#C8102E", linetype = "solid", size = 0.9) + 
  scale_x_continuous(breaks = c(1890, 1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010, 2020, 2030)) + 
  scale_y_continuous(labels = label_comma(), breaks = c(0,5000, 10000, 15000, 20000, 25000, 30000, 35000, 40000)) + 
  theme_bw() + 
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
        panel.background = element_rect(fill = "#FEE7E8"),
        panel.grid.major = element_line(colour = "#192343", linetype = "solid", size = 0.4)) + 
  ggtitle("Felte elg i Norge 1889-2024")
ggsave("elg.jpg")
```

```{r}
library(ggplot2)

# Data
N <- seq(0, 1, length.out = 200)
K <- 1
r <- 1
recruitment <- r * N * (1 - N/K)
df <- data.frame(N = N, recruitment = recruitment)

# Fangstlinjer
hi <- 0.15
hm <- max(recruitment)
hh <- 0.35

# Lag plottet
ggplot(df, aes(x = N, y = recruitment)) +
  geom_line(size = 1, colour = "#192343") +
  geom_hline(yintercept = hi, colour = "green", linetype = "dashed", size = 1) +
  geom_hline(yintercept = hm, colour = "orange", linetype = "dashed", size = 1) +
  geom_hline(yintercept = hh, colour = "red", linetype = "dashed", size = 1) +
  annotate("text", x = 0.5, y = hi + 0.02,
           label = "Lav fangst, bestand stabil", colour = "green") +
  annotate("text", x = 0.5, y = hm + 0.02,
           label = "MSY, maksimalt uttak", colour = "orange") +
  annotate("text", x = 0.5 , y = hh + 0.02,
           label = "For høy fangst, bestand kollapser", colour = "red") +
  labs(x = "Bestandstetthet (N/K)",
       y = "Netto rekruttering / fangst",
       title = "Maksimalt bærekraftig uttak (MSY)") +
  theme_minimal(base_size = 14)
```
```{r}
# Parametere
K <- 1000
r <- 1
N <- seq(0, K, length.out = 200)

# Netto rekruttering (logistisk modell)
recruitment <- r * N * (1 - N/K)
df <- data.frame(N = N, recruitment = recruitment)

# Fangstlinjer
hi <- 150      # lav fangst
hm <- max(recruitment)  # MSY
hh <- 350      # høy fangst

# Lag plottet
ggplot(df, aes(x = N, y = recruitment)) +
  geom_line(size = 1, colour = "#192343") +
 geom_hline(yintercept = hi, colour = "#03591D", linetype = "dashed", size = 1) +
  geom_hline(yintercept = hm, colour = "orange", linetype = "dashed", size = 1) +
  geom_hline(yintercept = hh, colour = "#C8102E", linetype = "dashed", size = 1) +
annotate("text", x = 500, y = hi + 20,
          label = "Lav fangst, bestand stabil", colour = "#03591D") +
  annotate("text", x = 500, y = hm + 20,
           label = "MSY, maksimalt uttak", colour = "orange") +
  annotate("text", x = 500, y = hh + 20,
           label = "For høy fangst, bestand kollapser", colour = "#C8102E") +
  labs(x = "Bestand (N)",
       y = "Netto rekruttering / fangst") +
  theme_minimal(base_size = 14) +
  ylim(0,400) +
  xlim(0,1000)
ggsave("MSY.jpg", width = 6, height = 4)
```

